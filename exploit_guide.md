# Guía de desarrollo de exploits para Ataka

## Plantilla de exploit y storages
Los exploits del ataka siempre deben estar escritos en base a las plantillas de ataka y deben ser contenedores de docker

De cada servicio se pueden obtener varias flags por medio de los storages, como ejemplo una sqli que permite leer la base de datos puede tener flags en varios ids, esos ids se dan en cada tick para cada equipo. Por esto es muy importante que los exploits utilicen la info dada en los storages. Los storages se pueden ver con `atk flag ids` y se pueden probar flags extraidas con `atk flag submit FLAG`.

> **Importante**: Ataka extrae las flags de la salida del exploit mediante regex.


## Test del exploit
Por lo general existe el NOP team que tiene los servicios sin parchear, para probar los exploits lo mejor es atacarlos a ellos. Dos cosas importantes, un exploit que funcione para el NOP no tiene porque funcionar para los demas equipos y las flags de NOP no cuentan nada pero se pueden subir para comprobar que todo va correctamente. En ataka se puede usar el comando `atk exploit runlocal`.

## Subir exploits
Una vez que el exploit es funcional se puede subir al servidor para empezar a atacar a los demas equipos. Los exploits se añaden con el comando `atk exploit upload`, antes de subirse lanzan una prueba contra el NOP.

> **Importante**: los nombres de los exploits deben de identificar tanto el servicio como la vulnerabilidad que explotan.

Para comprobar que el exploit se ha subido se usa `atk exploit ls`. Para comprobar los logs `atk exploit logs EXPLOIT_ID`.

## Exploits obsoletos
Cuando un exploit deja de funcionar se puede deshabilitar/habilitar con `atk exploit activate/deactivate`.

## Actualizar exploits
Si se vuelve a subir un exploit el servidor le asigna un número de versión, para cambiar entre versiones `atk switch EXPLOIT`.

## Descargar exploits
Los exploits en el servidor se descargan con `atk exploit download EXPLOIT OUTPUT_DIR`